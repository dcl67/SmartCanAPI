{% extends 'base.html' %}
{% load staticfiles %}

<!-- CSS Styles -->
<style>
    .speech {border: 1px solid #DDD; width: 300px; padding: 0; margin: 0}
    .speech input {border: 0; width: 240px; display: inline-block; height: 30px;}
    .speech img {float: right; width: 40px }
  </style>

{% block content %}

<h1>Welcome to SmartCan!</h1>

{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

<form id="labnol" action="{% url 'VoteHandler:dispose' %}" method="POST">
    {% csrf_token %}
    <label>Enter the item you wish to dispose of:</label>
    <input type="text" name="disposable_item" id="dispose_input" required>
    <img onclick="startDictation()" src="//i.imgur.com/cHidSVu.gif" />
    <input type="submit" id="dispose_submit" value="Enter">
</form>

    <p><h4>Or enter your desired bin number here: </h4></p> 

  <table style="float:left;  border-left-width:25px">
  <tr>
      {% for b in bins %}
      <td>
        <div class="Bin_selection" style="background: #f0f0f0; width: 10vw; height: 10vw; float: left;" href="#">
            <h3 style="color:black;">Bin {{ b.bin_num }}</h3>
          </a>{% comment %}TODO: New endpoint to dispose by bin, endpoint fires off request thru websocket{% endcomment %}
        </div>
      </td>
    {% endfor %}
  </tr>
  </table>
  </div>
</div>



{% comment %} Speech recognition from Google
Borrowed and adapted from the original code at https://www.labnol.org/software/add-speech-recognition-to-website/19989/
{% endcomment %}
<script>
    function startDictation() {
  
      if (window.hasOwnProperty('webkitSpeechRecognition')) {
  
        var recognition = new webkitSpeechRecognition();
  
        recognition.continuous = false;
        recognition.interimResults = false;
  
        recognition.lang = "en-US";
        recognition.start();
  
        recognition.onresult = function(e) {
          document.getElementById('dispose_input').value
                                   = e.results[0][0].transcript;
          recognition.stop();
          document.getElementById('labnol').submit();
          //document.getElementById('labnol');
        };
  
        recognition.onerror = function(e) {
          recognition.stop();
        }
  
      }
    }
  </script>

{% endblock %}